# Introduction

This project is a web application designed to view repository data fetched from
the GitHub API. The application retrieves repositories, extracts the required
fields, stores them in a SQL Server database, and then sends the repositories to
the frontend for viewing.

Users can view repositories sorted by updatedAt date, number of stars, or number
of forks. Additionally, users can filter repositories by topic or language and
sort them in ascending or descending order based on the provided criteria.

The backend is built using ASP.NET Core Web API, while the frontend is developed
using ASP.NET Core MVC. Both applications will be hosted on Azure App Service.

# Software dependencies

+ .NET 6.0 or higher
+ SQL Server 2019 or higher(for the database)
+ Visual Studio 2022

# Getting Started

Follow these steps to get the code up and running on your system:

## Installation process

1. Clone the repository using git clone [repository-url](https://github.com/FacultyUpskillingOrg/GitHubRepository-Backend.git)
2. Navigate to the project folder and open the solution file in Visual Studio.
3. Create a json file inside GitHubRepoTrackerBE and name it appsettings.json and update it as below.



## Configuration settings

### appsettings.json format

```
{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "ConnectionStrings": {
    "SQL_CONNECTION_STRING": "Server=[your SQL server name];Database=[Database name];TrustServerCertificate=True;Trusted_Connection=True;MultipleActiveResultSets=True"
  },
  "GithubSettings": {
    "GitHubAccessToken": "your_github_access_token_here"
  },
  "Jwt": {
    "Key": "your_jwt_key_here",
    "Issuer": "your_jwt_issuer_here",
    "Audience": "your_jwt_audience_here",
    "Subject": "JWT for GitRepositoryTracker"
  },
  "GitHubDataFetcherSettings": {
    "Size": "Repository size in KBs",
    "Page": "Number of pages to be returned",
    "PerPage": "Number of items per page",
    "FetchIntervalInHours": "Periodic interval in hours"
  },
  "AllowedHosts": "*",
}
```

Make sure to update the following settings in the appsettings.json file according to your environment:

- **ConnectionStrings:DefaultConnection** - Update with your database connection string.
- **GithubSettings:GitHubAccessToken** - Provide your GitHub Personal Access Token.

- **Jwt:Key, Jwt:Issuer, Jwt:Audience** - Update with appropriate values for JWT authentication.
  - **Jwt:Key**: This is a secret key used to sign the JWT, ensuring that the token is generated and verified by your application. It should be a strong and unique value, kept secret and not shared with anyone outside your application.
  - **Jwt:Issuer**: This property indicates the "issuer" of the JWT, which is usually your application's URL or a unique identifier for your application. The issuer is used to validate that the token was generated by your application and not by an attacker.
  - **Jwt:Audience**: This property specifies the "audience" of the JWT, which is usually the intended recipient of the token. In most cases, it will be the same as the issuer. The audience is used to ensure that the token is intended for your application and not for a different application.
  
  Read more on [JWT](https://jwt.io/)

- **GitHubDataFetcherSettings:** Settings for the scheduled service to fetch repositories from GitHub
  - **Size**: Repository size in KBs
  - **Page**: Number of pages to be returned
  - **PerPage**: Number of items per page
  - **FetchIntervalInHours**: Periodic interval in hours
-**NOTE** :The above settings are used to fetch the repositories from GitHub API. The default values are set to fetch 100 repositories with size greater than 100KBs. The periodic interval is set to 24 hours. You can change these values according to your requirements.
The settings are to be used for local testing, ensure you set the appropriate values in the Azure App Service configuration settings when deploying the application.
Do not push the secrets to the repository.

## Setting up local SQL Database
### Installation
+ Install SQL Server 2019 or higher and [SQL Server Management Studio](https://learn.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-ver16)
+ Create a database 

### Migrations
Note: Make sure to update the sql connection string with your local database connection string.
+ Open the package manager console on you your Visual studio with your project open
+ Run ``` Add-Migration InitialCreate``` to add migration
+ Run ``` Update-Database``` to update the database

# API references

Refer to the [GitHub API documentation](https://docs.github.com/en/rest?apiVersion=2022-11-28) for more information on the API used in this project.

# Build and Test

1. In Visual Studio, make sure you have the latest NuGet packages installed.
2. Set up a SQL Server database and update the connection string in the appsettings.json file accordingly.
3. Build the solution using Ctrl + Shift + B or Build > Build Solution.
4. Run the tests by navigating to Test > Run All Tests.
5. To run the application, press F5 or click Debug > Start Debugging.

# License
 Code is Licensed under the MIT License. See [MIT LICENSE](https://github.com/FacultyUpskillingOrg/GitHubRepository-Backend/blob/main/LICENSE) for more details.

# Contribute

We welcome contributions from the community to make this code better. If you'd like to contribute, please follow these steps:

1. Fork the repository.
2. Create a new branch with a descriptive name (e.g., feature-add-new-filter).
3. Commit your changes to the new branch.
4. Push the branch to your forked repository.
5. Create a pull request targeting the main branch of the original repository.

Please make sure to follow the code style and conventions used throughout the project. Add unit tests for your new features or bug fixes to ensure the stability and quality of the codebase.
